SELECT title
FROM film
WHERE film_id IN (
    SELECT i.film_id
    FROM inventory i
    JOIN rental r ON i.inventory_id = r.inventory_id
    JOIN payment p ON r.rental_id = p.rental_id
    WHERE p.customer_id IN (
        SELECT p2.customer_id
        FROM payment p2
        GROUP BY p2.customer_id
        HAVING SUM(p2.amount) > 100
    )
);
